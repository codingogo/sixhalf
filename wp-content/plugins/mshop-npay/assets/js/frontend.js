var mnpIsMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return mnpIsMobile.Android()||mnpIsMobile.BlackBerry()||mnpIsMobile.iOS()||mnpIsMobile.Opera()||mnpIsMobile.Windows()}};mnpIsMobile.any()?document.write("<script type='text/javascript' src='"+mshop_naverpay.button_js_url_mobile+"' charset='UTF-8'><\/script>"):document.write("<script type='text/javascript' src='"+mshop_naverpay.button_js_url_pc+"' charset='UTF-8'><\/script>");var MNP_Hook={hooks:[],add_filter:function(a,b){void 0===MNP_Hook.hooks[a]&&(MNP_Hook.hooks[a]=[]),MNP_Hook.hooks[a].push(b)},apply_filters:function(a,arguments){if(void 0!==MNP_Hook.hooks[a])for(i=0;i<MNP_Hook.hooks[a].length;++i)arguments[0]=MNP_Hook.hooks[a][i](arguments);return arguments[0]}};jQuery(function(a){function b(){var b=[];if($wrapper=jQuery(mshop_naverpay.wrapper_selector+":first"),$quantity=1,$qty=$wrapper.find('input[name="quantity"]'),$qty.length>0&&($quantity=$qty.val()),$wrapper.hasClass(mshop_naverpay.product_variable_class)){if(h){var c=($wrapper.find('input[name="product_id"]').val(),h.attributes);a.each(c,function(a,b){c[a]=$wrapper.find('select[name="'+a+'"]').val()}),b.push({product_id:$wrapper.find('input[name="variation_id"]').val(),parent_product_id:$wrapper.find('input[name="product_id"]').val(),quantity:$quantity,attributes:c})}}else $wrapper.hasClass(mshop_naverpay.product_simple_class)&&b.push({product_id:$wrapper.find('[name="add-to-cart"]').val(),parent_product_id:"",quantity:$quantity,attributes:null});return MNP_Hook.apply_filters("get_product_info",[b])}function c(c){if(!1!==a("#checkout_button_wrapper").triggerHandler("npay-process-purchase",this)){var d=b();_.isEmpty(d)?alert("구매할 상품의 옵션을 선택하세요."):e(a("#checkout_button_wrapper").parent())||(f(a("#checkout_button_wrapper").parent()),a.ajax({type:"post",dataType:"json",url:mshop_naverpay.ajax_url,data:{action:mshop_naverpay.create_order_action,products:d},success:function(b){if(b.success){var c=mshop_naverpay.order_url_pc+b.data.authkey+"/"+b.data.shopcode;if(mnpIsMobile.any()&&(c=mshop_naverpay.order_url_mobile+b.data.authkey+"/"+b.data.shopcode),mnpIsMobile.any()||"in-page"===mshop_naverpay.transition_mode)window.location.href=c;else{null===window.open(c,"_blank")&&alert("팝업이 차단되어 있습니다. 팝업설정을 변경하신 후 다시 시도해주세요.")}}else alert(b.data.message);g(a("#checkout_button_wrapper").parent())},error:function(){g(a("#checkout_button_wrapper").parent())}}))}}function d(c){var d=b();_.isEmpty(d)?alert("구매할 상품의 옵션을 선택하세요."):e(a("#checkout_button_wrapper").parent())||(f(a("#checkout_button_wrapper").parent()),a.ajax({type:"post",dataType:"json",url:mshop_naverpay.ajax_url,data:{action:mshop_naverpay.add_to_wishlist_action,products:d},success:function(b){if(b.success)if(mnpIsMobile.any()){var c=a(b.data.html);a("body").append(c),c.submit()}else{var d=window.open("","","scrollbars=yes,width=400,height=267");null===d?alert("팝업이 차단되어 있습니다. 팝업설정을 변경하신 후 다시 시도해주세요."):d.document.write(b.data.html)}else alert(b.data.message);g(a("#checkout_button_wrapper").parent())},error:function(){g(a("#checkout_button_wrapper").parent())}}))}var e=function(a){return a.is(".processing")||a.parents(".processing").length},f=function(a){e(a)||a.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},g=function(a){a.removeClass("processing").unblock()},h=null;naver.NaverPayButton.apply({BUTTON_KEY:mshop_naverpay.button_key,TYPE:mnpIsMobile.any()?mshop_naverpay.button_type_mobile:mshop_naverpay.button_type_pc,COLOR:mshop_naverpay.button_color,COUNT:2,ENABLE:"Y",EMBED_ID:"checkout_button_wrapper",BUY_BUTTON_HANDLER:c,WISHLIST_BUTTON_HANDLER:d}),$variation_form=a("form.variations_form"),$variation_form.length>0&&($variation_form.on("found_variation",function(b,c){c.is_in_stock&&c.display_price>0?(h=JSON.parse(JSON.stringify(c)),mshop_naverpay.hide_if_not_purchaseable?a("#checkout_button_wrapper").css("display","block"):a("#checkout_button_wrapper").removeClass("disabled")):(h=null,mshop_naverpay.hide_if_not_purchaseable?a("#checkout_button_wrapper").css("display","none"):a("#checkout_button_wrapper").addClass("disabled"))}),$variation_form.on("hide_variation",function(b,c){h=null,mshop_naverpay.hide_if_not_purchaseable?a("#checkout_button_wrapper").css("display","none"):a("#checkout_button_wrapper").addClass("disabled")}),$variation_form.trigger("check_variations",["",!1]))});